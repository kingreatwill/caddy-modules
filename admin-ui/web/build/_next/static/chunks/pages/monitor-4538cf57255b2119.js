(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[69],{809:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/monitor",function(){return n(1930)}])},1930:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Monitor}});var l=n(5893),r=n(7294),a=n(3156),i=n(5861),o=n(5616),s=n(1703),c=n(44),d=n(3027),p=n(7058),h=n(3841),f=n(5819),m=n(4054),u=n(9560),x=n(7918),Z=n(7906),b=n(295),j=n(3252),g=n(3184),v=n(3816);let parseMetrics=e=>{let t=e.split(/\n|\r\n/),n={};return t.forEach(e=>{if(/(^\s+)?#/.test(e))return;let[t,l]=e.split(/\s+/);t&&(n[t]=Number(l))}),n};function TabPanel(e){let{children:t,value:n,index:r,...a}=e;return(0,l.jsx)("div",{role:"tabpanel",hidden:n!==r,id:"vertical-tabpanel-".concat(r),"aria-labelledby":"vertical-tab-".concat(r),...a,children:n===r&&(0,l.jsx)(o.Z,{sx:{p:3},children:(0,l.jsx)(i.Z,{children:t})})})}function a11yProps(e){return{id:"vertical-tab-".concat(e),"aria-controls":"vertical-tabpanel-".concat(e)}}let y={PaperProps:{style:{maxHeight:224,width:1e3}}};function Monitor(){var e;let[t,n]=r.useState(""),[w,_]=r.useState([]),[C,O]=r.useState(0),k=r.useCallback(async()=>{let e=await fetch("/metrics"),t=await e.text();n(t);let l=parseMetrics(t),r=[{time:Date.now(),data:l}].concat(w).slice(0,240);_(r)},[w]);r.useEffect(()=>{k();let e=setInterval(()=>{k()},3e4);return()=>clearInterval(e)},[]);let[N,P]=r.useState([]),M=w[0],S=Object.keys(null!==(e=null==M?void 0:M.data)&&void 0!==e?e:{});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.Z,{}),(0,l.jsx)(a.Z,{maxWidth:"lg",children:(0,l.jsxs)(o.Z,{sx:{my:4},children:[(0,l.jsx)(i.Z,{variant:"h4",component:"h1",gutterBottom:!0,children:"Caddy Server Metrics"}),(0,l.jsxs)(o.Z,{sx:{flexGrow:1,bgcolor:"background.paper",display:"flex",height:224},children:[(0,l.jsxs)(s.Z,{orientation:"vertical",variant:"scrollable",value:C,onChange:(e,t)=>{O(t)},"aria-label":"Vertical tabs example",sx:{borderRight:1,borderColor:"divider",minWidth:100},children:[(0,l.jsx)(c.Z,{label:"Raw",...a11yProps(0)}),(0,l.jsx)(c.Z,{label:"Parsed",...a11yProps(1)}),(0,l.jsx)(c.Z,{label:"Metric",...a11yProps(2)})]}),(0,l.jsx)(TabPanel,{value:C,index:0,children:(0,l.jsx)("pre",{children:t})}),(0,l.jsx)(TabPanel,{value:C,index:1,children:(0,l.jsx)("pre",{children:JSON.stringify(w[0],null,4)})}),(0,l.jsxs)(TabPanel,{value:C,index:2,children:[(0,l.jsx)("div",{children:(0,l.jsxs)(m.Z,{sx:{m:1,width:800},children:[(0,l.jsx)(h.Z,{id:"demo-multiple-chip-label",children:"Select Metric"}),(0,l.jsx)(u.Z,{labelId:"demo-multiple-chip-label",id:"demo-multiple-chip",multiple:!0,value:N,onChange:e=>{let{target:{value:t}}=e;P("string"==typeof t?t.split(","):t)},input:(0,l.jsx)(p.Z,{id:"select-multiple-chip",label:"Chip"}),renderValue:e=>(0,l.jsx)(o.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map(e=>(0,l.jsx)(x.Z,{label:e},e))}),MenuProps:y,children:S.map(e=>(0,l.jsx)(f.Z,{value:e,style:{fontWeight:-1===N.indexOf(e)?"normal":"500"},children:e},e))})]})}),(0,l.jsxs)(Z.Z,{sx:{minWidth:800},"aria-label":"simple table",children:[(0,l.jsx)(g.Z,{children:(0,l.jsxs)(v.Z,{children:[(0,l.jsx)(j.Z,{children:"time"}),N.map(e=>(0,l.jsx)(j.Z,{children:e},"m-".concat(e)))]})}),(0,l.jsx)(b.Z,{children:w.map(e=>(0,l.jsxs)(v.Z,{children:[(0,l.jsx)(j.Z,{children:new Date(e.time).toISOString()}),N.map(t=>(0,l.jsx)(j.Z,{children:e.data[t]},"t-".concat(e.time,"-").concat(t)))]},"t-".concat(e.time)))})]})]})]})]})})]})}},3027:function(e,t,n){"use strict";n.d(t,{Z:function(){return src_AppBar}});var l=n(2729),r=n(6811),a=n(917),i=n(7294),o=n(2293),s=n(5616),c=n(155),d=n(3946),p=n(5861),h=n(517),f=n(326),m=n(3156),u=n(9417),x=n(5819),Z=n(3960),b=n(5893),j=n(5697),g=n.n(j),v=n(512),y=n(1163),w=n(1664),_=n.n(w),C=n(3795),O=n(948);let k=(0,O.ZP)("a")({}),N=i.forwardRef(function(e,t){let{to:n,linkAs:l,replace:r,scroll:a,shallow:i,prefetch:o,locale:s,...c}=e;return(0,b.jsx)(_(),{href:n,prefetch:o,as:l,replace:r,scroll:a,shallow:i,passHref:!0,locale:s,children:(0,b.jsx)(k,{ref:t,...c})})});N.propTypes={href:g().any,linkAs:g().oneOfType([g().object,g().string]),locale:g().string,passHref:g().bool,prefetch:g().bool,replace:g().bool,scroll:g().bool,shallow:g().bool,to:g().oneOfType([g().object,g().string]).isRequired};let P=i.forwardRef(function(e,t){let{activeClassName:n="active",as:l,className:r,href:a,linkAs:i,locale:o,noLinkStyle:s,prefetch:c,replace:d,role:p,scroll:h,shallow:f,...m}=e,u=(0,y.useRouter)(),x="string"==typeof a?a:a.pathname,Z=(0,v.Z)(r,{[n]:u.pathname===x&&n}),j="string"==typeof a&&(0===a.indexOf("http")||0===a.indexOf("mailto:"));if(j)return s?(0,b.jsx)(k,{className:Z,href:a,ref:t,...m}):(0,b.jsx)(C.Z,{className:Z,href:a,ref:t,...m});let g={to:a,linkAs:i||l,replace:d,scroll:h,shallow:f,prefetch:c,locale:o};return s?(0,b.jsx)(N,{className:Z,ref:t,...g,...m}):(0,b.jsx)(C.Z,{component:N,className:Z,ref:t,...g,...m})});function _templateObject(){let e=(0,l._)(["\n                      color: white;\n                    "]);return _templateObject=function(){return e},e}function _templateObject1(){let e=(0,l._)(["\n                    color: white;\n                  "]);return _templateObject1=function(){return e},e}P.propTypes={activeClassName:g().string,as:g().oneOfType([g().object,g().string]),className:g().string,href:g().any,linkAs:g().oneOfType([g().object,g().string]),locale:g().string,noLinkStyle:g().bool,prefetch:g().bool,replace:g().bool,role:g().string,scroll:g().bool,shallow:g().bool};let M=[{name:"Upstream",href:"/upstream"},{name:"PKI",href:"/pki-view"},{name:"Load",href:"/setup"},{name:"Adapt",href:"/convert-config"},{name:"Metrics",href:"/monitor"}];var src_AppBar=()=>{let[e,t]=i.useState(null),handleCloseNavMenu=()=>{t(null)};return(0,r.tZ)(o.Z,{position:"static",children:(0,r.tZ)(m.Z,{maxWidth:"lg",children:(0,r.BX)(c.Z,{disableGutters:!0,children:[(0,r.tZ)(Z.Z,{sx:{display:{xs:"none",md:"flex"},mr:1}}),(0,r.tZ)(p.Z,{variant:"h6",noWrap:!0,component:"a",href:"/",sx:{mr:2,display:{xs:"none",md:"flex"},fontFamily:"monospace",fontWeight:700,letterSpacing:".3rem",color:"inherit",textDecoration:"none"},children:"Caddy Config"}),(0,r.BX)(s.Z,{sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:[(0,r.tZ)(d.Z,{size:"large","aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:e=>{t(e.currentTarget)},color:"inherit",children:(0,r.tZ)(f.Z,{})}),(0,r.tZ)(h.Z,{id:"menu-appbar",anchorEl:e,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:!!e,onClose:handleCloseNavMenu,sx:{display:{xs:"block",md:"none"}},children:M.map(e=>(0,r.tZ)(x.Z,{onClick:handleCloseNavMenu,children:(0,r.tZ)(P,{href:e.href,css:(0,a.iv)(_templateObject()),children:(0,r.tZ)(p.Z,{textAlign:"center",children:e.name})})},e.name))})]}),(0,r.tZ)(Z.Z,{sx:{display:{xs:"flex",md:"none"},mr:1}}),(0,r.tZ)(p.Z,{variant:"h5",noWrap:!0,component:"a",href:"",sx:{mr:2,display:{xs:"flex",md:"none"},flexGrow:1,fontFamily:"monospace",fontWeight:700,letterSpacing:".3rem",color:"inherit",textDecoration:"none"},children:"Caddy Config"}),(0,r.tZ)(s.Z,{sx:{flexGrow:1,display:{xs:"none",md:"flex"}},children:M.map(e=>(0,r.tZ)(u.Z,{onClick:handleCloseNavMenu,sx:{my:2,color:"white",display:"block"},children:(0,r.tZ)(P,{href:e.href,css:(0,a.iv)(_templateObject1()),children:e.name})},e.name))})]})})})}}},function(e){e.O(0,[937,691,774,888,179],function(){return e(e.s=809)}),_N_E=e.O()}]);